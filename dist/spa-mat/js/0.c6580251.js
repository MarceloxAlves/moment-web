(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{"5eEK":function(t,e,o){},D5OQ:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-layout",{attrs:{view:"lHh Lpr lFf"}},[o("q-layout-header",[o("q-toolbar",{attrs:{color:"secondary"}},[o("q-toolbar-title",[o("q-btn",{attrs:{flat:"",label:"Moment"},on:{click:function(e){t.$router.push("/")}}}),o("div",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("Marketplace de eventos")])],1),o("q-btn",{attrs:{push:"",color:"secondary",dense:"",icon:"shopping_cart"},on:{click:function(e){t.cart=!t.cart}}}),t._v("  \n      "),o("q-btn",{attrs:{push:"",label:"Criar Conta",color:"yellow-10",dense:"",icon:"people"},on:{click:function(e){t.$router.push("/cadastro")}}}),t._v("  \n      "),o("q-btn",{attrs:{push:"",label:"Acessar",color:"green-6",dense:"",icon:"lock"},on:{click:function(e){t.$router.push("/acesso")}}})],1)],1),o("q-page-container",[o("cart",{attrs:{opened:t.cart},on:{fechei:function(e){t.cart=!1}}}),o("router-view")],1)],1)},i=[];a._withStripped=!0;var s=o("4IOb"),n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-modal",{attrs:{"content-css":{minWidth:"80vw",minHeight:"80vh"}},on:{show:function(e){t.atualiza()},hide:function(e){t.notify()}},model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}},[o("q-modal-layout",[o("q-toolbar",{attrs:{slot:"header",color:"secondary"},slot:"header"},[o("q-toolbar-title",[t._v("\n         Minha compra\n      ")])],1),o("q-list",{attrs:{highlight:""}},[o("q-list-header",[t._v("Meus Itens")]),t._l(t.atividades,function(e){return t._t("default",[o("q-item",[o("q-item-main",{attrs:{label:e.nome}}),o("q-item-side",[t._v(t._s(e.valor))]),o("q-item-side",{attrs:{right:""}},[o("q-btn",{attrs:{round:"",flat:"",color:"red",icon:"remove_circle"},on:{click:function(o){t.remover_atividade(e)}}})],1)],1)])}),o("q-item",{attrs:{disabled:""}},[o("q-item-main",{attrs:{label:"Total"}}),o("q-item-side",[t._v(t._s(t.total))]),o("q-item-side",{attrs:{right:""}})],1)],2),o("q-page-container",[o("div",{staticClass:"row"},[o("div",{staticClass:"col-2"}),o("div",{staticClass:"col-2"},[o("q-input",{attrs:{"stack-label":"Inserir cupom"},model:{value:t.cupom,callback:function(e){t.cupom=e},expression:"cupom"}})],1),o("div",{staticClass:"col-2"},[o("q-btn",{attrs:{color:"orange",label:"Aplicar"},on:{click:t.adicionar_cupom}})],1),o("div",{staticClass:"col-3"}),o("div",{staticClass:"col-2"},[o("q-btn",{attrs:{color:"secondary",label:"Finalizar Compra"},on:{click:t.finalizar_compra}})],1)])])],1)],1)},r=[];n._withStripped=!0;var c={name:"cart",props:["opened"],error:!0,warning:!1,data:function(){return{atividades:[],cupom:"",desconto:0,total:0,evento:null,usuario:null}},created:function(){this.atualiza(),console.log(this.atividades)},methods:{notify:function(){this.$emit("fechei")},atualiza:function(){var t=s["Ga"].get.item("cart");null!=t&&(this.atividades=t),this.total=this.atividades.reduce(function(t,e){return t+e.valor},0);var e=s["Ga"].get.item("cupom");null!=e&&(this.desconto=e.desconto,this.total-=this.total*this.desconto)},remover_atividade:function(t){this.$moment.remove_array(this.atividades,t),s["Ga"].set("cart",this.atividades),this.atualiza()},adicionar_cupom:function(){var t=this;this.$http.get("/cupom/aplicar/"+this.cupom,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){if("success"==e.data.result.status){t.$q.notify({message:e.data.result.msg,timeout:3e3,type:"positive",color:"positive",textColor:"white",icon:"check"});var o=e.data.result.response.cupom;s["Ga"].set("cupom",o),t.desconto=o.desconto,t.total-=t.total*t.desconto}else erros.length>0&&t.$q.notify({message:e.data.result.msg,timeout:3e3,type:"negative",color:"red",textColor:"white",icon:"error"})}).catch(function(e){console.log(e),t.$q.notify({message:"Cupom inválido ou já utilizado!",timeout:3e3,type:"negative",color:"red",textColor:"white",icon:"error"})})},preparar_ids_atividades:function(){for(var t=Array(),e=0;e<this.atividades.length;e++)t.push({id:this.atividades[e].id}),this.evento=this.atividades[e].evento;return t},get_dados_usuario:function(){var t=this;this.$http.get("/usuario/"+s["Ga"].get.item("email"),{}).then(function(e){t.usuario=e.data.result.response.usuario,t.teste(),t.inscricao_cadastrar(t.usuario.id)}).catch(function(t){Dialog.create({title:"Error",message:"Não foi possível carregar os eventos"})})},finalizar_compra:function(){var t=s["Ga"].get.item("email");null==t?this.$router.push("/acesso"):this.get_dados_usuario()},teste:function(){var t=this.preparar_ids_atividades();console.log({id:null,desconto:this.desconto,atividades:t,evento:{id:this.evento},usuario:{id:this.usuario.id}})},inscricao_cadastrar:function(t){var e=this,o=this.preparar_ids_atividades();this.$http.post("/inscricao/cadastrar",{headers:{"Content-Type":"application/json;charset=UTF-8"},id:null,desconto:this.desconto,atividades:o,evento:{id:this.evento},usuario:{id:this.usuario.id}}).then(function(t){e.$q.notify({message:"Inscrição realizada com sucesso!",timeout:3e3,type:"positive",color:"positive",textColor:"white",icon:"check"}),s["Ga"].remove("cupom"),e.$router.push("/painel")}).catch(function(t){console.log(t)})}}},l=c,u=(o("XZ7U"),o("KHd+")),d=Object(u["a"])(l,n,r,!1,null,"ea22eeea",null),p=d.exports,h={name:"LayoutDefault",components:{Cart:p},data:function(){return{leftDrawerOpen:this.$q.platform.is.desktop,cart:!1}},created:function(){},methods:{openURL:s["Ja"]}},v=h,m=(o("toy4"),Object(u["a"])(v,a,i,!1,null,null,null));e["default"]=m.exports},XZ7U:function(t,e,o){"use strict";var a=o("n/pM"),i=o.n(a);i.a},"n/pM":function(t,e,o){},toy4:function(t,e,o){"use strict";var a=o("5eEK"),i=o.n(a);i.a}}]);